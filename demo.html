<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="format-detection" content="telephone=no, email=no, address=no" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />

    <title>file-promisify demo</title>

    <script type="application/javascript" src="//unpkg.com/file-promisify/dist/file-promisify.min.js"></script>
  </head>
  <body>
    <h2>file-promisify demo</h2>

    <p>
      <a href="javascript:void(0);" onclick="toSelect();">Select a file</a>
    </p>

    <p>
      <a href="javascript:void(0);" onclick="toSelectMultiple();">Select multi files</a>
    </p>

    <p>
      <a href="javascript:void(0);" onclick="toSelectImage();">Select an image file</a>
    </p>

    <p>
      image orientation: <code id="outputOrientation"></code>
    </p>

    <p>
      image data url (first 128 chars): <code id="outputDataUrl"></code>
    </p>

    <p>
      crop image into 128 &times; 128 exactly: <code id="outputImageCroppedLog"></code>
    </p>

    <p>
      <img id="outputImageCropped" />
    </p>

    <p>
      wrap image into maximum 128 &times; 128: <code id="outputImageWrappedLog"></code>
    </p>

    <p>
      <img id="outputImageWrapped" />
    </p>

    <script type="application/javascript">
      window.document.addEventListener('DOMContentLoaded', function () {
      }, false)

      window.toSelect = function () {
        window.Files.select()
          .then(function (file) {
            window.alert(`You've selected: ${file.name}`)
          })
          .catch(function (error) {
            window.alert(`Error: ${error.message}`)
          })
      }

      window.toSelectMultiple = function () {
        window.Files.select({ multiple: true })
          .then(function (files) {
            window.alert(`You've selected ${files.length} files.`)
          })
          .catch(function (error) {
            window.alert(`Error: ${error.message}`)
          })
      }

      window.toSelectImage = function () {
        window.Files.select({ accept: 'image/*' })
          .then(function (file) {
            window.alert(`You've selected: ${file.name}`)
            return file
          })
          .then(function (file) {
            window.Files.getImageOrientation(file)
              .then(function (orientation) {
                window.document.getElementById('outputOrientation').innerText = JSON.stringify(orientation)
              })
              .catch(function (error) {
                window.document.getElementById('outputOrientation').innerText = `Error: ${error.message}`
              })

            window.Files.blobToDataUrl(file)
              .then(function (dataUrl) {
                window.document.getElementById('outputDataUrl').innerText = dataUrl.substring(0, 128)
              })
              .catch(function (error) {
                window.document.getElementById('outputDataUrl').innerText = `Error: ${error.message}`
              })

            window.Files.processImage({ blob: file, width: 128, height: 128, crop: true })
              .then(function (dataUrl) {
                window.document.getElementById('outputImageCropped').src = dataUrl
              })
              .catch(function (error) {
                window.document.getElementById('outputImageCroppedLog').innerText = `Error: ${error.message}`
              })

            window.Files.processImage({ blob: file, width: 128, height: 128, crop: false })
              .then(function (dataUrl) {
                window.document.getElementById('outputImageWrapped').src = dataUrl
              })
              .catch(function (error) {
                window.document.getElementById('outputImageWrappedLog').innerText = `Error: ${error.message}`
              })
          })
          .catch(function (error) {
            window.alert(`Error: ${error.message}`)
          })
      }
    </script>
  </body>
</html>
